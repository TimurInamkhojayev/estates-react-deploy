{"ast":null,"code":"import axios from'axios';import{config}from'../../Constants';import{parseJwt}from'./Helpers';export const estateApi={authenticate,signup,numberOfUsers,numberOfEstates,getUsers,deleteUser,getEstates,deleteEstate,addEstate};function authenticate(username,password){return instance.post('/auth/authenticate',{username,password},{headers:{'Content-type':'application/json'}});}function signup(user){return instance.post('/auth/signup',user,{headers:{'Content-type':'application/json'}});}function numberOfUsers(){return instance.get('/public/numberOfUsers');}function numberOfEstates(){return instance.get('/public/numberOfEstates');}function getUsers(user,username){const url=username?\"/api/users/\".concat(username):'/api/users';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteUser(user,username){return instance.delete(\"/api/users/\".concat(username),{headers:{'Authorization':bearerAuth(user)}});}function getEstates(user,text){const url=text?\"/api/estates?text=\".concat(text):'/api/estates';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteEstate(user,id){return instance.delete(\"/api/estates/\".concat(id),{headers:{'Authorization':bearerAuth(user)}});}function addEstate(user,estate){return instance.post('/api/estates',estate,{headers:{'Content-type':'application/json','Authorization':bearerAuth(user)}});}// -- Axios\nconst instance=axios.create({baseURL:config.url.API_BASE_URL});instance.interceptors.request.use(function(config){// If token is expired, redirect user to login\nif(config.headers.Authorization){const token=config.headers.Authorization.split(' ')[1];const data=parseJwt(token);if(Date.now()>data.exp*1000){window.location.href=\"/login\";}}return config;},function(error){return Promise.reject(error);});// -- Helper functions\nfunction bearerAuth(user){return\"Bearer \".concat(user.accessToken);}","map":{"version":3,"names":["axios","config","parseJwt","estateApi","authenticate","signup","numberOfUsers","numberOfEstates","getUsers","deleteUser","getEstates","deleteEstate","addEstate","username","password","instance","post","headers","user","get","url","concat","bearerAuth","delete","text","id","estate","create","baseURL","API_BASE_URL","interceptors","request","use","Authorization","token","split","data","Date","now","exp","window","location","href","error","Promise","reject","accessToken"],"sources":["/Users/timurinamkhojayev/Desktop/inamkhojayev-java-spring-project-main/estate-client-react/src/components/misc/EstateApi.js"],"sourcesContent":["import axios from 'axios'\nimport { config } from '../../Constants'\nimport { parseJwt } from './Helpers'\n\nexport const estateApi = {\n  authenticate,\n  signup,\n  numberOfUsers,\n  numberOfEstates,\n  getUsers,\n  deleteUser,\n  getEstates,\n  deleteEstate,\n  addEstate\n}\n\nfunction authenticate(username, password) {\n  return instance.post('/auth/authenticate', { username, password }, {\n    headers: { 'Content-type': 'application/json' }\n  })\n}\n\nfunction signup(user) {\n  return instance.post('/auth/signup', user, {\n    headers: { 'Content-type': 'application/json' }\n  })\n}\n\nfunction numberOfUsers() {\n  return instance.get('/public/numberOfUsers')\n}\n\nfunction numberOfEstates() {\n  return instance.get('/public/numberOfEstates')\n}\n\nfunction getUsers(user, username) {\n  const url = username ? `/api/users/${username}` : '/api/users'\n  return instance.get(url, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction deleteUser(user, username) {\n  return instance.delete(`/api/users/${username}`, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction getEstates(user, text) {\n  const url = text ? `/api/estates?text=${text}` : '/api/estates'\n  return instance.get(url, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction deleteEstate(user, id) {\n  return instance.delete(`/api/estates/${id}`, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction addEstate(user, estate) {\n  return instance.post('/api/estates', estate, {\n    headers: {\n      'Content-type': 'application/json',\n      'Authorization': bearerAuth(user)\n    }\n  })\n}\n\n// -- Axios\n\nconst instance = axios.create({\n  baseURL: config.url.API_BASE_URL\n})\n\ninstance.interceptors.request.use(function (config) {\n  // If token is expired, redirect user to login\n  if (config.headers.Authorization) {\n    const token = config.headers.Authorization.split(' ')[1]\n    const data = parseJwt(token)\n    if (Date.now() > data.exp * 1000) {\n      window.location.href = \"/login\"\n    }\n  }\n  return config\n}, function (error) {\n  return Promise.reject(error)\n})\n\n// -- Helper functions\n\nfunction bearerAuth(user) {\n  return `Bearer ${user.accessToken}`\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}